# ML_DZ1
**Что было сделано:**
1. Был проведен EDA данных: начиная с анализа сырых данных и заканчивая их обработкой в используемый финально вид. Были обработаны дубликаты (удалены), пропуски (заполнены медианами), удалены трудно обрабатываемые столбцы (name и torque), очищены числовые столбцы от лишних строковых значений. Дополнительно был построен дашборд по датасету, который оказался особенно информативен при обработке данных, так как на основании него сразу можно было получить ответы на все вопросы о данных.
2. Визуализации: помимо требуемых в задании (визуализация распределения признаков и их корреляции с целевой переменной) были также построены дополнительные графики, отражающие поведение целевой переменной с категориальными переменными. Основные задачи по визуализации касались только вещественных показателей.
3. Построены несколько варианты линейных моделей:
    На вещественных данных: дефолтная линейная регрессия, со стандартизацией данных, с Лассо регуляризацией (обычная и с GridSearch, который показал alpha = 8901, веса почти не занулялись, так как были гораздо выше порога, а зануление доп весов сказывалось на худшем качестве) и Elastic Net (GridSearch дал модель с alpha = 100 и l1 = 0)
    На всех переменных (добавление категориальных переменных): закодила с помощью OHE категориальные переменные, на новых данных данных была построена Ridge модель с aplha = 100 (GridSearch). Качество модели оказалось лучше остальных.
4. Написана бизнес-метрика и по ней были сравнены все построенные модели. Последняя оказалась лучше.
5. Реализован сервис с Fast API: был написан код реализации (на модели с вещественными показателями и предварительной обработкой инпут данных) и код тестирования, однако запуск тестирования не удался (ничего не происходило). Код приложен в репозиторий для логической проверки действий.

**Основные выводы**

*По обработке*
- Тренировочные и тестовые данные распределены примерно одинаково
- Корреляция целевой переменной наибольшая с engine, max_power и годом (что вполне ожидаемо :) )
- В целевой переменной есть выбросы, однако они не были обработаны в данной работе, так как это могут быть вполне реальные цены (из-за роста стоимостей с годами)
- Во всех категориях есть числовой перевес одних категорий над другими. При этом для некоторых selling_price ощутимо выше, чем в остальных.

*По моделям*
- Улучшение регуляризацией, станартизацией не дало значимого улучшения для модели на вещественных показателях
- Качество несколько увеличивается с добавлением категориальных переменных
- Бизнес-качество модели с категориальными переменными выше, чем у остальных

*По FastAPI*
- Код сервиса технически (тестирования или самого сервиса) не получилось реализовать корректно, так как тест не запускался, при этом содержательно сервис был построен корректно, на модели на вещественных показателях (т.к.последняя модель на всех данных не отличилась сильным бустом в качестве)

**Что не получилось :(**
Не получилось реализовать FastAPI сервис, есть ощущение, что пропущено какие-то запускающие (?) механизмы, так как на тестировании при вызове response сама переменная не была найдена. Понять, что именно было некорректно в коде тестирования (а может и реализации) также не удалось, к сожалению :(
Если будет возможность, было бы очень классно посмотреть на хороший пример реализации! :) Возможно, кто-то из коллег готов будет поделиться.
